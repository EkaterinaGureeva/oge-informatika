<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ОГЭ Информатика — Тренажёр (Задание 8)</title>
<style>
  :root {
    --bg:#f6fbff; --card:#ffffff; --ink:#0f172a; --muted:#64748b;
    --blue:#1d4ed8; --blue2:#0ea5e9; --line:#e2e8f0;
    --ok:#16a34a; --bad:#dc2626; --shadow:0 10px 30px rgba(2,8,23,.08);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#eef7ff, #f6fbff 55%);color:var(--ink);}
  .topbar{position:sticky;top:0;z-index:20;background:rgba(246,251,255,.92);backdrop-filter:blur(10px);border-bottom:1px solid var(--line);}
  .topbarInner{max-width:1200px;margin:0 auto;padding:10px 14px;display:flex;align-items:center;gap:10px;flex-wrap:nowrap;overflow:hidden}
  .badge{width:38px;height:38px;border-radius:999px;display:grid;place-items:center;
    background:radial-gradient(circle at 30% 30%, #93c5fd, #1d4ed8);color:white;font-weight:700;}
  .titleWrap{min-width:0;display:flex;flex-direction:column;line-height:1.1}
  .title{font-size:18px;font-weight:500;color:var(--blue);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .subtitle{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .spacer{flex:1}
  .btn{border:1px solid var(--line);background:white;border-radius:10px;padding:8px 10px;font-size:13px;color:var(--ink);
    display:inline-flex;align-items:center;gap:8px;cursor:pointer;white-space:nowrap}
  .btn.primary{background:linear-gradient(90deg,var(--blue),var(--blue2));border:none;color:white;}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  .select{border:1px solid var(--line);background:white;border-radius:10px;padding:8px 10px;font-size:13px;color:var(--ink);white-space:nowrap;max-width:280px}
  .wrap{max-width:1200px;margin:0 auto;padding:16px 14px;display:grid;grid-template-columns:1fr 320px;gap:14px}
  @media (max-width: 980px){.wrap{grid-template-columns:1fr} .sidebar{order:-1}}
  .notice{background:linear-gradient(90deg, #e0f2fe, #eff6ff);border:1px solid var(--line);border-radius:14px;padding:12px 14px;box-shadow:var(--shadow)}
  .notice b{color:var(--blue);font-weight:600}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow);}
  .taskHead{display:flex;align-items:center;justify-content:space-between;padding:14px 14px 0 14px;gap:10px}
  .taskNum{display:flex;align-items:center;gap:10px;min-width:0}
  .pill{font-size:12px;color:var(--blue);background:#eff6ff;border:1px solid #dbeafe;border-radius:999px;padding:6px 10px;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis}
  .numCircle{width:34px;height:34px;border-radius:999px;display:grid;place-items:center;background:#eff6ff;border:1px solid #dbeafe;color:var(--blue);font-weight:700}
  .taskBody{padding:12px 14px 14px 14px}
  .taskText p{margin:8px 0;color:var(--ink);line-height:1.5}
  .tblWrap{overflow:auto;border:1px solid var(--line);border-radius:12px;background:#fbfdff;margin:10px 0 12px 0}
  table.dataTable{border-collapse:separate;border-spacing:0;width:100%;min-width:420px}
  .dataTable th{text-align:left;background:#eef7ff;color:#0b3b9e;font-weight:600;font-size:13px;padding:10px;border-bottom:1px solid var(--line)}
  .dataTable td{font-size:13px;padding:10px;border-bottom:1px solid var(--line);vertical-align:top}
  .dataTable tr:last-child td{border-bottom:none}
  .answerRow{display:flex;gap:10px;align-items:center;margin-top:10px}
  .in{flex:1;border:1px solid var(--line);border-radius:12px;padding:10px 12px;font-size:14px}
  .lockNote{font-size:12px;color:var(--muted)}
  .mark{font-weight:700}
  .mark.ok{color:var(--ok)} .mark.bad{color:var(--bad)}
  .sidebar{position:sticky;top:74px;align-self:start}
  .sideInner{padding:14px}
  .sideTitle{font-size:14px;color:var(--blue);font-weight:600;margin:0 0 10px 0}
  .scoreBox{display:grid;gap:10px}
  .metric{border:1px solid var(--line);border-radius:14px;padding:10px 12px;background:linear-gradient(180deg,#ffffff,#f7fbff)}
  .metric .k{font-size:12px;color:var(--muted)} .metric .v{font-size:20px;font-weight:700;color:var(--blue)}
  .scale{border:1px dashed #c7d2fe;border-radius:14px;padding:10px 12px;color:var(--muted);font-size:12px;line-height:1.35;background:#fbfdff}
  .scale b{color:var(--blue);font-weight:600}
  .modal{position:fixed;inset:0;background:rgba(2,8,23,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
  .modal.open{display:flex}
  .modalCard{max-width:860px;width:100%;background:white;border-radius:16px;border:1px solid var(--line);box-shadow:var(--shadow);max-height:85vh;overflow:auto}
  .modalHead{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--line)}
  .modalTitle{color:var(--blue);font-weight:600}
  .modalBody{padding:12px 14px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width: 780px){.grid{grid-template-columns:1fr}}
  .row{border:1px solid var(--line);border-radius:14px;padding:10px 12px}
  .row .h{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}
  .row .h .n{font-weight:700;color:var(--blue)} .row .h .c{font-size:12px;color:var(--muted)}
  .row input{width:100%;border:1px solid var(--line);border-radius:12px;padding:10px 12px;font-size:14px}
  .pinRow{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:12px}
  .pinRow input{border:1px solid var(--line);border-radius:12px;padding:10px 12px;font-size:14px}
  .muted{color:var(--muted)}
</style>
</head>
<body>
<div class="topbar">
  <div class="topbarInner">
    <div class="badge">8</div>
    <div class="titleWrap">
      <div class="title">Учебный тренажёр ОГЭ по информатике</div>
      <div class="subtitle">Задание 8 • Язык запросов (логические операции)</div>
    </div>
    <div class="spacer"></div>
    <select id="filterSel" class="select" title="Категория">
      <option value="ALL">Все задания</option>
    </select>
    <button class="btn" id="btnTeacher">Учитель</button>
    <button class="btn primary" id="btnCheck">Проверить</button>
    <button class="btn" id="btnReset">Сбросить</button>
    <button class="btn" id="btnPrint">Печать / PDF</button>
  </div>
</div>

<div class="wrap">
  <div class="main">
    <div class="notice card">
      <div style="font-size:13px;line-height:1.45;color:var(--ink)">
        <b>Важно:</b> нажимайте <b>«Проверить»</b> только после окончания работы.
        После проверки <b>исправление уже введённых ответов и добавление новых</b> будет недоступно.
        По итогам проверки тренажёр покажет <b>баллы</b> и <b>оценку</b>.
      </div>
    </div>
    <div id="globalIntro" class="card" style="margin-top:14px;padding:14px 14px 6px 14px"></div>
    <div id="tasks"></div>
  </div>

  <div class="sidebar card">
    <div class="sideInner">
      <div class="sideTitle">Оценка и баллы</div>
      <div class="scoreBox">
        <div class="metric">
          <div class="k">Набрано баллов</div>
          <div class="v"><span id="score">0</span> / <span id="total">0</span></div>
        </div>
        <div class="metric">
          <div class="k">Итог по выполненным заданиям</div>
          <div class="v"><span id="grade">—</span></div>
        </div>
        <div class="scale">
          <b>Шкала:</b><br>
          80–100% → 5<br>
          60–79% → 4<br>
          40–59% → 3<br>
          0–39% → 2
        </div>
        <div class="muted" style="font-size:12px">
          Каждое правильно выполненное задание оценивается в 1 балл.
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal" id="teacherModal" aria-hidden="true">
  <div class="modalCard">
    <div class="modalHead">
      <div class="modalTitle">Режим учителя</div>
      <button class="btn" id="btnCloseTeacher">Закрыть</button>
    </div>
    <div class="modalBody">
      <div id="teacherLocked">
        <div class="pinRow">
          <div class="muted">Введите PIN-код:</div>
          <input id="pinInput" type="password" inputmode="numeric" autocomplete="off" placeholder="PIN"/>
          <button class="btn primary" id="btnPinEnter">Войти</button>
        </div>
        <div class="muted" style="font-size:12px">По умолчанию PIN: <b>1234</b> (можно изменить после входа).</div>
      </div>

      <div id="teacherUnlocked" style="display:none">
        <div class="pinRow">
          <div class="muted">Новый PIN:</div>
          <input id="newPin" type="password" inputmode="numeric" autocomplete="off" placeholder="Новый PIN (4–8 цифр)"/>
          <button class="btn" id="btnSavePin">Сохранить PIN</button>
          <span class="muted" style="font-size:12px">PIN и ответы хранятся в браузере.</span>
        </div>
        <div class="muted" style="font-size:12px;margin-bottom:10px">
          Здесь можно редактировать правильные ответы. Изменения сохраняются и применяются при проверке.
        </div>
        <div class="grid" id="teacherGrid"></div>
        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:12px;flex-wrap:wrap">
          <button class="btn" id="btnResetTeacherAnswers">Сбросить ответы к значениям из файла</button>
          <button class="btn primary" id="btnSaveTeacherAnswers">Сохранить ответы</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const TASKS = [
  {
    "idx": 1,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц в тысячах будет найдено по запросу</p><p>Суфле | Корзинка | Эклер?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Суфле</td><td>450</td></tr><tr><td>Корзинка</td><td>200</td></tr><tr><td>Эклер</td><td>490</td></tr><tr><td>Суфле &amp; Корзинка</td><td>70</td></tr><tr><td>Суфле &amp; Эклер</td><td>160</td></tr><tr><td>Корзинка &amp; Эклер</td><td>0</td></tr></tbody></table></div>",
    "answer": "910"
  },
  {
    "idx": 2,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу</p><p>Чай &amp; Чашка | Кофе?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Чай</td><td>528</td></tr><tr><td>Чашка</td><td>436</td></tr><tr><td>Кофе</td><td>553</td></tr><tr><td>Чай | Чашка | Кофе</td><td>1120</td></tr><tr><td>Кофе &amp;Чашка</td><td>250</td></tr></tbody></table></div>",
    "answer": "147"
  },
  {
    "idx": 3,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу</p><p>Мёд &amp; Блин &amp; Масленица ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Мёд &amp; (Блин | Масленица)</td><td>285</td></tr><tr><td>Мёд &amp; | Масленица</td><td>174</td></tr><tr><td>Блин &amp; Мёд</td><td>163</td></tr></tbody></table></div>",
    "answer": "52"
  },
  {
    "idx": 4,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу</p><p>Утро | День | Ночь ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Утро</td><td>356</td></tr><tr><td>День</td><td>365</td></tr><tr><td>Ночь</td><td>287</td></tr><tr><td>Ночь &amp; (День | Утро)</td><td>120</td></tr><tr><td>Утро &amp; День</td><td>250</td></tr></tbody></table></div>",
    "answer": "638"
  },
  {
    "idx": 5,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу</p><p>Крош | Пин | Бараш ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Крош</td><td>283</td></tr><tr><td>Бараш</td><td>340</td></tr><tr><td>Пин</td><td>504</td></tr><tr><td>Крош &amp; Пин</td><td>278</td></tr><tr><td>Крош &amp; Бараш</td><td>0</td></tr><tr><td>Пин &amp; Бараш</td><td>89</td></tr></tbody></table></div>",
    "answer": "760"
  },
  {
    "idx": 6,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Шампунь &amp; Кондиционер | Бальзам &amp; Кондиционер ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Шампунь &amp; Кондиционер &amp; Бальзам</td><td>245</td></tr><tr><td>Бальзам &amp; Кондиционер</td><td>443</td></tr><tr><td>Шампунь &amp; Кондиционер</td><td>528</td></tr></tbody></table></div>",
    "answer": "726"
  },
  {
    "idx": 7,
    "variant": "Вариант",
    "promptHtml": "<p>Сколько страниц будет найдено по запросу</p><p>Атос &amp; (Портос | Арамис) ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Атос &amp; Портос</td><td>335</td></tr><tr><td>Атос &amp; Арамис</td><td>235</td></tr><tr><td>Атос &amp; Портос &amp; Арамис</td><td>120</td></tr></tbody></table></div>",
    "answer": "450"
  },
  {
    "idx": 8,
    "variant": "Вариант",
    "promptHtml": "<p>Сколько страниц будет найдено по запросу</p><p>ландыши &amp; васильки &amp; лютики ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>васильки &amp; ландыши</td><td>650</td></tr><tr><td>ландыши &amp; лютики</td><td>230</td></tr><tr><td>ландыши &amp; (васильки | лютики)</td><td>740</td></tr></tbody></table></div>",
    "answer": "140"
  },
  {
    "idx": 9,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тыс.) будет найдено по запросу</p><p>ОГЭ &amp; (ЕГЭ | Информатика) ?</p><p>«&amp;».В таблице выше приведены запросы и количество.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Информатика &amp; ОГЭ</td><td>110</td></tr><tr><td>ЕГЭ &amp; ОГЭ</td><td>80</td></tr><tr><td>ЕГЭ &amp; Информатика &amp; ОГЭ</td><td>30</td></tr></tbody></table></div>",
    "answer": "160"
  },
  {
    "idx": 10,
    "variant": "Вариант",
    "promptHtml": "<p>Какое количество страниц (в тыс.) будет найдено по запросу</p><p>(Дневник &amp; Учебник) | (Дневник &amp; Тетрадь) ?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Дневник &amp; Учебник &amp; Тетрадь</td><td>49</td></tr><tr><td>Дневник &amp; Учебник</td><td>113</td></tr><tr><td>Дневник &amp; Тетрадь</td><td>186</td></tr></tbody></table></div>",
    "answer": "300"
  },
  {
    "idx": 11,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Шёлк | Китай?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Шёлк &amp; Китай</td><td>780</td></tr><tr><td>Шёлк</td><td>1230</td></tr><tr><td>Китай</td><td>3210</td></tr></tbody></table></div>",
    "answer": "3660"
  },
  {
    "idx": 12,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Берн?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Цюрих &amp; Берн</td><td>1550</td></tr><tr><td>Цюрих</td><td>6400</td></tr><tr><td>Цюрих | Берн</td><td>7200</td></tr></tbody></table></div>",
    "answer": "2350"
  },
  {
    "idx": 13,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Соболь &amp; Куница?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Соболь | Куница</td><td>6500</td></tr><tr><td>Куница</td><td>4300</td></tr><tr><td>Соболь</td><td>3780</td></tr></tbody></table></div>",
    "answer": "1580"
  },
  {
    "idx": 14,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Волга &amp; Ока &amp; Кама?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Волга &amp; (Ока | Кама)</td><td>405</td></tr><tr><td>Волга &amp; Ока</td><td>215</td></tr><tr><td>Волга &amp; Кама</td><td>310</td></tr></tbody></table></div>",
    "answer": "120"
  },
  {
    "idx": 15,
    "variant": "Вариант 1",
    "promptHtml": "<p>Компьютер печатает количество страниц (в тысячах), которое будет найдено по следующему запросу: Диана &amp; Паллада</p><p>Укажите целое число, которое напечатает компьютер</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Диана &amp; (Аврора | Паллада)</td><td>800</td></tr><tr><td>Диана &amp; Аврора &amp; Паллада</td><td>220</td></tr><tr><td>Диана &amp; Аврора</td><td>550</td></tr></tbody></table></div>",
    "answer": "470"
  },
  {
    "idx": 16,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Динамо &amp; Спартак?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Динамо &amp; (Зенит | Спартак)</td><td>840</td></tr><tr><td>Динамо &amp; Зенит</td><td>530</td></tr><tr><td>Динамо &amp; Зенит &amp; Спартак</td><td>130</td></tr></tbody></table></div>",
    "answer": "440"
  },
  {
    "idx": 17,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу</p><p>Грибы &amp; (Рыбалка | Охота)?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Грибы &amp; Рыбалка</td><td>134</td></tr><tr><td>Грибы &amp; Охота</td><td>243</td></tr><tr><td>Грибы &amp; Рыбалка &amp; Охота</td><td>78</td></tr></tbody></table></div>",
    "answer": "299"
  },
  {
    "idx": 18,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу Апельсин &amp; Лимон?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Прокофьев</td><td>87</td></tr><tr><td>Апельсин</td><td>39</td></tr><tr><td>Лимон</td><td>52</td></tr><tr><td>Прокофьев | Апельсин | Лимон</td><td>150</td></tr><tr><td>Прокофьев &amp; Апельсин</td><td>19</td></tr><tr><td>Прокофьев &amp; Лимон</td><td>0</td></tr></tbody></table></div>",
    "answer": "9"
  },
  {
    "idx": 19,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу</p><p>Напряжённость | Поле | Пшеница?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Поле</td><td>45</td></tr><tr><td>Пшеница</td><td>24</td></tr><tr><td>Напряжённость</td><td>44</td></tr><tr><td>Поле &amp; Пшеница</td><td>17</td></tr><tr><td>Напряжённость &amp; Поле</td><td>19</td></tr><tr><td>Напряжённость &amp; Пшеница</td><td>0</td></tr></tbody></table></div>",
    "answer": "77"
  },
  {
    "idx": 20,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу Слон?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Ладья</td><td>25</td></tr><tr><td>Хобот</td><td>28</td></tr><tr><td>Ладья | Слон | Хобот</td><td>66</td></tr><tr><td>Слон &amp; Хобот</td><td>20</td></tr><tr><td>Ладья &amp; Слон</td><td>12</td></tr><tr><td>Ладья &amp; Хобот</td><td>0</td></tr></tbody></table></div>",
    "answer": "45"
  },
  {
    "idx": 21,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу</p><p>Музыка &amp; Баритон?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Музыка</td><td>77</td></tr><tr><td>Шаляпин</td><td>23</td></tr><tr><td>Баритон</td><td>81</td></tr><tr><td>Музыка | Шаляпин | Баритон</td><td>131</td></tr><tr><td>Шаляпин &amp; Музыка</td><td>5</td></tr><tr><td>Шаляпин &amp; Баритон</td><td>0</td></tr></tbody></table></div>",
    "answer": "45"
  },
  {
    "idx": 22,
    "variant": "Вариант 1",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке возрастания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>Франция | Испания | История</td></tr><tr><td>2</td><td>Франция &amp; Карта &amp; История</td></tr><tr><td>3</td><td>Франция | История</td></tr><tr><td>4</td><td>Франция &amp; История</td></tr></tbody></table></div>",
    "answer": "2431"
  },
  {
    "idx": 23,
    "variant": "Вариант 1",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке убывания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>Рим &amp; Париж &amp; Лондон</td></tr><tr><td>2</td><td>Лондон | Рим</td></tr><tr><td>3</td><td>Рим &amp; Лондон</td></tr><tr><td>4</td><td>Рим | Париж | Лондон</td></tr></tbody></table></div>",
    "answer": "4231"
  },
  {
    "idx": 24,
    "variant": "Вариант 1",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке возрастания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>Хоккей &amp; Волейбол</td></tr><tr><td>2</td><td>Футбол &amp; Хоккей &amp; Волейбол</td></tr><tr><td>3</td><td>Футбол | Хоккей | Волейбол</td></tr><tr><td>4</td><td>Футбол | (Хоккей &amp; Волейбол)</td></tr></tbody></table></div>",
    "answer": "4231"
  },
  {
    "idx": 25,
    "variant": "Вариант 1",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке убывания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>Тюль | Карниз | Портьера</td></tr><tr><td>2</td><td>Тюль &amp; Карниз &amp; Портьера</td></tr><tr><td>3</td><td>Карниз | Портьера</td></tr><tr><td>4</td><td>Тюль &amp; (Карниз | Портьера)</td></tr></tbody></table></div>",
    "answer": "2143"
  },
  {
    "idx": 26,
    "variant": "Вариант 1",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Стихи | Книга?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц (в тысячах)</th></tr></thead><tbody><tr><td>Книга &amp; Стихи</td><td>540</td></tr><tr><td>Книга</td><td>1880</td></tr><tr><td>Стихи</td><td>3110</td></tr></tbody></table></div>",
    "answer": "1342"
  },
  {
    "idx": 27,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу Скорпион?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Скорпион | Козерог</td><td>3100</td></tr><tr><td>Козерог</td><td>1700</td></tr><tr><td>Скорпион &amp; Козерог</td><td>800</td></tr></tbody></table></div>",
    "answer": "4450"
  },
  {
    "idx": 28,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу крейсер &amp; линкор?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>крейсер | линкор</td><td>7000</td></tr><tr><td>крейсер</td><td>4800</td></tr><tr><td>линкор</td><td>4500</td></tr></tbody></table></div>",
    "answer": "2200"
  },
  {
    "idx": 29,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу ландыши &amp; васильки &amp; лютики?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>ландыши &amp; (васильки | лютики)</td><td>740</td></tr><tr><td>ландыши &amp; лютики</td><td>230</td></tr><tr><td>васильки &amp; ландыши</td><td>650</td></tr></tbody></table></div>",
    "answer": "2300"
  },
  {
    "idx": 30,
    "variant": "Вариант 2",
    "promptHtml": "<p>Компьютер печатает количество страниц (в тысячах), которое будет найдено по следующему запросу: март &amp; июнь</p><p>Укажите целое число, которое напечатает компьютер</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>март &amp; (май | июнь)</td><td>520</td></tr><tr><td>март &amp; май &amp; июнь</td><td>150</td></tr><tr><td>март &amp; май</td><td>420</td></tr></tbody></table></div>",
    "answer": "140"
  },
  {
    "idx": 31,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу бадминтон &amp; гольф?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>(теннис | бадминтон) &amp; гольф</td><td>790</td></tr><tr><td>теннис &amp; гольф</td><td>555</td></tr><tr><td>теннис &amp; бадминтон &amp; гольф</td><td>220</td></tr></tbody></table></div>",
    "answer": "250"
  },
  {
    "idx": 32,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в тысячах) будет найдено по запросу</p><p>Хоккей &amp; (Россия | Канада)?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц <br>(в тысячах)</th></tr></thead><tbody><tr><td>Хоккей &amp; Россия</td><td>168</td></tr><tr><td>Хоккей &amp; Канада</td><td>237</td></tr><tr><td>Хоккей &amp; Россия &amp; Канада</td><td>79</td></tr></tbody></table></div>",
    "answer": "455"
  },
  {
    "idx": 33,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу</p><p>Толстой &amp; Тютчев?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Прозаик</td><td>68</td></tr><tr><td>Толстой</td><td>98</td></tr><tr><td>Тютчев</td><td>73</td></tr><tr><td>Прозаик | Толстой | Тютчев</td><td>184</td></tr><tr><td>Прозаик &amp; Толстой</td><td>14</td></tr><tr><td>Прозаик &amp; Тютчев</td><td>0</td></tr></tbody></table></div>",
    "answer": "326"
  },
  {
    "idx": 34,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу</p><p>Марка | Автомобиль | Филателист?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Марка</td><td>103</td></tr><tr><td>Автомобиль</td><td>102</td></tr><tr><td>Филателист</td><td>69</td></tr><tr><td>Филателист &amp; Марка</td><td>10</td></tr><tr><td>Марка &amp; Автомобиль</td><td>25</td></tr><tr><td>Филателист &amp; Автомобиль</td><td>0</td></tr></tbody></table></div>",
    "answer": "41"
  },
  {
    "idx": 35,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу Нос?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Горло</td><td>45</td></tr><tr><td>Корабль</td><td>38</td></tr><tr><td>Горло | Корабль | Нос</td><td>93</td></tr><tr><td>Корабль &amp; Нос</td><td>15</td></tr><tr><td>Горло &amp; Нос</td><td>25</td></tr><tr><td>Горло &amp; Корабль</td><td>0</td></tr></tbody></table></div>",
    "answer": "239"
  },
  {
    "idx": 36,
    "variant": "Вариант 2",
    "promptHtml": "<p>Какое количество страниц (в сотнях тысяч) будет найдено по запросу</p><p>Шишкин &amp; Рафаэль?</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Запрос</th><th>Найдено страниц<br>(в сотнях тысяч)</th></tr></thead><tbody><tr><td>Передвижник</td><td>97</td></tr><tr><td>Шишкин</td><td>111</td></tr><tr><td>Рафаэль</td><td>87</td></tr><tr><td>Передвижник | Шишкин | Рафаэль</td><td>257</td></tr><tr><td>Передвижник &amp; Шишкин</td><td>15</td></tr><tr><td>Передвижник &amp; Рафаэль</td><td>0</td></tr></tbody></table></div>",
    "answer": "50"
  },
  {
    "idx": 37,
    "variant": "Вариант 2",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке возрастания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>Литература | История | Экзамен</td></tr><tr><td>2</td><td>Экзамен &amp; Литература</td></tr><tr><td>3</td><td>Экзамен | История</td></tr><tr><td>4</td><td>История &amp; Литература &amp; Экзамен</td></tr></tbody></table></div>",
    "answer": "23"
  },
  {
    "idx": 38,
    "variant": "Вариант 2",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке убывания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>(Париж &amp; Москва) | Прага</td></tr><tr><td>2</td><td>Париж &amp; Москва &amp; Прага</td></tr><tr><td>3</td><td>(Париж | Москва) &amp; Прага</td></tr><tr><td>4</td><td>Париж | Прага</td></tr></tbody></table></div>",
    "answer": "4231"
  },
  {
    "idx": 39,
    "variant": "Вариант 2",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке возрастания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>логика &amp; (математика | программирование)</td></tr><tr><td>2</td><td>логика &amp; математика</td></tr><tr><td>3</td><td>логика &amp; математика &amp; программирование</td></tr><tr><td>4</td><td>логика | математика</td></tr></tbody></table></div>",
    "answer": "4132"
  },
  {
    "idx": 40,
    "variant": "Вариант 2",
    "promptHtml": "<p>В таблице приведены запросы к поисковому серверу. Расположите обозначения запросов в порядке убывания количества страниц, которые нашёл поисковый сервер по каждому запросу. По всем запросам было найдено разное количество страниц.</p>",
    "tablesHtml": "<div class=\"tblWrap\"><table class=\"dataTable\"><thead><tr><th>Код</th><th>Запрос</th></tr></thead><tbody><tr><td>1</td><td>Солнце | Воздух | Вода</td></tr><tr><td>2</td><td>(Солнце &amp; Воздух) | Вода</td></tr><tr><td>3</td><td>Солнце &amp; Воздух</td></tr><tr><td>4</td><td>Солнце &amp; Воздух &amp; Вода</td></tr></tbody></table></div>",
    "answer": "3214"
  }
];
const INTRO = [];

const LS_KEY_STUDENT = "oge8_student_state_v2";
const LS_KEY_TEACHER_PIN = "oge8_teacher_pin_v2";
const LS_KEY_TEACHER_ANS = "oge8_teacher_answers_v2";

// при новом открытии — ответы ученика не сохраняем
localStorage.removeItem(LS_KEY_STUDENT);

function esc(s){return String(s||"").replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[m]));}

function gradeFromPercent(p) {
  if (p>=80) return "5";
  if (p>=60) return "4";
  if (p>=40) return "3";
  return "2";
}

function defaultTeacherAnswers() {
  const m={};
  for (const t of TASKS) m[t.idx]=String(t.answer||"").trim();
  return m;
}

function getTeacherPin() {
  return localStorage.getItem(LS_KEY_TEACHER_PIN) || "1234";
}
function setTeacherPin(pin) {
  localStorage.setItem(LS_KEY_TEACHER_PIN, pin);
}
function getTeacherAnswers() {
  const raw = localStorage.getItem(LS_KEY_TEACHER_ANS);
  if (!raw) return defaultTeacherAnswers();
  try {
    const obj = JSON.parse(raw);
    const def = defaultTeacherAnswers();
    return Object.assign(def, obj);
  } catch(e) {
    return defaultTeacherAnswers();
  }
}
function setTeacherAnswers(obj) {
  localStorage.setItem(LS_KEY_TEACHER_ANS, JSON.stringify(obj));
}

let teacherAnswers = getTeacherAnswers();
let checked = false;

function fillFilter() {
  const sel = document.getElementById("filterSel");
  const variants = Array.from(new Set(TASKS.map(t=>t.variant)));
  for (const v of variants) {
    const opt=document.createElement("option");
    opt.value=v; opt.textContent=v;
    sel.appendChild(opt);
  }
}

function renderIntro() {
  const box=document.getElementById("globalIntro");
  const p = (INTRO||[]).filter(x=>x && !/^ОТВЕТЫ/i.test(x));
  if (!p.length) { box.style.display="none"; return; }
  box.innerHTML = "<div class='taskText'>" + p.map(x=>"<p>"+esc(x)+"</p>").join("") + "</div>";
}

function renderTasks() {
  const filter = document.getElementById("filterSel").value;
  const wrap=document.getElementById("tasks");
  wrap.innerHTML="";
  const list = TASKS.filter(t=>filter==="ALL" ? true : t.variant===filter);
  document.getElementById("total").textContent = String(list.length);
  for (const t of list) {
    const card=document.createElement("div");
    card.className="card";
    card.style.marginTop="14px";
    card.dataset.idx=t.idx;

    const head=document.createElement("div");
    head.className="taskHead";
    head.innerHTML = `
      <div class="taskNum">
        <div class="numCircle">${esc(t.idx)}</div>
        <div class="pill">${esc(t.variant)}</div>
      </div>
      <div id="mark-${t.idx}" class="mark"></div>
    `;

    const body=document.createElement("div");
    body.className="taskBody";
    body.innerHTML = `
      <div class="taskText">${t.promptHtml}</div>
      ${t.tablesHtml}
      <div class="answerRow">
        <input class="in" id="ans-${t.idx}" placeholder="Введите ответ" autocomplete="off"/>
      </div>
      <div class="lockNote">После проверки редактирование ответов будет недоступно.</div>
    `;

    card.appendChild(head);
    card.appendChild(body);
    wrap.appendChild(card);
  }
  updateScoreUI();
}

function normalizeAnswer(s) {
  return String(s||"").trim().replace(/\s+/g," ").toLowerCase();
}

function updateScoreUI(score=0,total=null) {
  const filter = document.getElementById("filterSel").value;
  const list = TASKS.filter(t=>filter==="ALL" ? true : t.variant===filter);
  const tot = total===null ? list.length : total;
  document.getElementById("score").textContent = String(score);
  document.getElementById("total").textContent = String(tot);
  const pct = tot>0 ? Math.round(score*100/tot) : 0;
  document.getElementById("grade").textContent = checked ? (gradeFromPercent(pct) + " ("+pct+"%)") : "—";
}

function checkAll() {
  const filter = document.getElementById("filterSel").value;
  const list = TASKS.filter(t=>filter==="ALL" ? true : t.variant===filter);
  let score=0;
  for (const t of list) {
    const input=document.getElementById("ans-"+t.idx);
    const mark=document.getElementById("mark-"+t.idx);
    const student = normalizeAnswer(input.value);
    const correct = normalizeAnswer(teacherAnswers[t.idx] || t.answer || "");
    const ok = (student.length>0) && (student===correct);
    if (ok) {
      score++;
      mark.textContent="✅ Верно";
      mark.className="mark ok";
    } else {
      mark.textContent="❌ Неверно";
      mark.className="mark bad";
    }
    input.disabled = true;
  }
  checked=true;
  document.getElementById("btnCheck").disabled=true;
  updateScoreUI(score, list.length);
}

function resetAll() {
  checked=false;
  document.getElementById("btnCheck").disabled=false;
  const filter = document.getElementById("filterSel").value;
  const list = TASKS.filter(t=>filter==="ALL" ? true : t.variant===filter);
  for (const t of list) {
    const input=document.getElementById("ans-"+t.idx);
    const mark=document.getElementById("mark-"+t.idx);
    if (input) {
      input.value="";
      input.disabled=false;
    }
    if (mark) {
      mark.textContent="";
      mark.className="mark";
    }
  }
  updateScoreUI(0, list.length);
}

function openTeacher() {
  document.getElementById("teacherModal").classList.add("open");
  document.getElementById("teacherModal").setAttribute("aria-hidden","false");
  document.getElementById("pinInput").value="";
}
function closeTeacher() {
  document.getElementById("teacherModal").classList.remove("open");
  document.getElementById("teacherModal").setAttribute("aria-hidden","true");
}

function unlockTeacher() {
  document.getElementById("teacherLocked").style.display="none";
  document.getElementById("teacherUnlocked").style.display="block";
  renderTeacherGrid();
}

function renderTeacherGrid() {
  teacherAnswers = getTeacherAnswers();
  const grid=document.getElementById("teacherGrid");
  grid.innerHTML="";
  for (const t of TASKS) {
    const div=document.createElement("div");
    div.className="row";
    div.innerHTML = `
      <div class="h">
        <div class="n">Задание ${t.idx}</div>
        <div class="c">${esc(t.variant)}</div>
      </div>
      <input id="tans-${t.idx}" value="${esc(teacherAnswers[t.idx]||"")}" placeholder="Правильный ответ"/>
      <div class="muted" style="font-size:12px;margin-top:6px">Ответ ученику не показывается.</div>
    `;
    grid.appendChild(div);
  }
}

document.getElementById("btnTeacher").addEventListener("click", openTeacher);
document.getElementById("btnCloseTeacher").addEventListener("click", closeTeacher);
document.getElementById("btnPinEnter").addEventListener("click", () => {
  const pin=document.getElementById("pinInput").value.trim();
  if (pin===getTeacherPin()) unlockTeacher();
  else alert("Неверный PIN");
});
document.getElementById("btnSavePin").addEventListener("click", () => {
  const np=document.getElementById("newPin").value.trim();
  if (!/^\d{4,8}$/.test(np)) return alert("PIN должен содержать 4–8 цифр.");
  setTeacherPin(np);
  alert("PIN сохранён.");
  document.getElementById("newPin").value="";
});
document.getElementById("btnSaveTeacherAnswers").addEventListener("click", () => {
  const obj={};
  for (const t of TASKS) {
    const v=document.getElementById("tans-"+t.idx).value;
    obj[t.idx]=String(v||"").trim();
  }
  setTeacherAnswers(obj);
  teacherAnswers=getTeacherAnswers();
  alert("Ответы сохранены.");
});
document.getElementById("btnResetTeacherAnswers").addEventListener("click", () => {
  if (!confirm("Сбросить ответы к значениям из файла?")) return;
  setTeacherAnswers(defaultTeacherAnswers());
  teacherAnswers=getTeacherAnswers();
  renderTeacherGrid();
});

document.getElementById("btnCheck").addEventListener("click", () => {
  if (!confirm("После проверки ответы нельзя будет изменить. Продолжить?")) return;
  checkAll();
});
document.getElementById("btnReset").addEventListener("click", () => resetAll());
document.getElementById("btnPrint").addEventListener("click", () => window.print());
document.getElementById("filterSel").addEventListener("change", () => renderTasks());

fillFilter();
renderIntro();
renderTasks();
</script>
</body>
</html>